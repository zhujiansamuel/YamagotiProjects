<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <title>iPhone17 買取相場 – 統合テンプレート（店舗列付き）</title>
    <style>
        .nodata {
            background: #ffffff !important;
            color: #000000 !important;
            font-weight: 200;
        }

        :root {
            --bg: #f6f7fb;
            --card: #ffffff;
            --grid-border: #d9deea;
            --header-bg: #ff9900;
            --text: #1f2430;
            --muted: #6b7380;
            --positive: #0f9d58;
            --negative: #d93025;
            --gap: -1px;
            --table-font: 12px; /* 表格字体大小 */
            --row-h: 22px; /* 行高（包含内容区高度） */
            --cell-px: 8px; /* 水平内边距 */
            --cell-py: 4px; /* 垂直内边距；若想严格固定行高，可设为 0 */
            --col-model-w: 140px;
            --col-capacity-w: 100px;
            --col-color-w: 120px;
            --col-num-w: 120px;
            --col-shop-w: 120px;

        }

        body {
            font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "PingFang SC", "Hiragino Sans", "Noto Sans CJK JP", Roboto, Arial;
            margin: 16px;
        }

        .wrap {
            margin: 3px 3px;
            margin-inline: auto; /* 等价于左右 auto，现代语法 */
            box-sizing: border-box; /* 防止内边距撑破宽度 */

        }

        fieldset {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
        }

        legend {
            padding: 0 6px;
            color: #111827;
            font-weight: 600;
        }

        label {
            font-size: 10px;
            color: #374151;
            display: block;
            margin-bottom: 6px;
        }

        * {
            box-sizing: border-box;
        }

        .card {
            background: var(--card);
            border: 1px solid var(--grid-border);
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, .05);
            margin: 30px auto;
            padding: 20px;
            overflow-x: auto;
        }

        .model-section {
            margin-bottom: -15px;
        }

        .model-header {
            background: var(--header-bg);
            padding: 10px 12px;
            font-weight: bold;
            border-bottom: 1px solid var(--grid-border);
        }

        table {
            width: 200px;
            border-collapse: collapse;
            table-layout: fixed;
        }

        th, td {
            height: var(--row-h); /* 固定行高 */
            line-height: calc(var(--row-h) - 2px); /* 粗略抵消边框高度；更严谨可把 cell-py 设为 0 */
            border: 1px solid var(--grid-border);
            padding: 6px 8px;
            text-align: right;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: var(--table-font);
            font-weight: 700;

        }

        th {
            background: var(--header-bg);
            text-align: center;
            height: var(--row-h);
            line-height: calc(var(--row-h) - 1px);
        }

        .row3 {
            display: grid;
            grid-template-columns: 1.2fr .9fr .9fr;
            gap: 10px;
        }

        .row4 {
            display: grid;
            grid-template-columns: .2fr .4fr .4fr .6fr;
            gap: 10px;
            max-width: 1500px;
        }

        label {
            font-size: 13px;
            color: #374151;
            display: block;
            margin-bottom: 6px;
        }

        input[type="text"], input[type="datetime-local"] {
            width: 80%;
            padding: 8px 10px;
            border-radius: 10px;
            border: 1px solid #d1d5db;
            outline: none;
        }

        input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, .15);
        }

        .btns {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        button {
            border: 0;
            padding: 9px 12px;
            border-radius: 10px;
            cursor: pointer;
            background: #111827;
            color: #fff;
        }

        button.secondary {
            background: #374151;
        }


        .col-model {
            width: 130px;
            text-align: center;

        }

        .col-capacity {
            width: 58px;
            text-align: center;
        }

        .col-color {
            width: 65px;
            text-align: center;
        }

        .col-num {
            width: 75px;
            text-align: center;
        }

        .shop-col {
            width: 75px;
            text-align: center;
        }


        .diff.pos {
            color: var(--positive);
            font-weight: bold;
        }

        .diff.neg {
            color: var(--negative);
            font-weight: bold;
        }

        #shops {
            display: grid;
            grid-template-columns: repeat(8, minmax(0, 1fr));
            gap: 6px 10px;
            max-height: 180px;
            overflow: auto;
        }


        /* 店舗ヘッダーの色（白文字）*/
        .shop-head {
            color: #fff;
            background: #351c75;
            font-weight: 500;
            line-height: 0.9; /* 行间距更紧凑，可在 1.0~1.2 间微调 */
            font-size: 14px;
        }

        .shop-time {
            font-size: 9px;
        }

        .shop-date {
            font-size: 6.5px;
        }

        .shop-買取商店 {
            background: #351c75
        }

        .shop-海峡通信 {
            background: #351c75
        }

        .shop-買取１丁目 {
            background: #351c75
        }

        .shop-モバイルミックス {
            background: #351c75
        }

        .shop-森森買取 {
            background: #351c75
        }

        .shop-買取ルデヤ {
            background: #351c75
        }

        .shop-買取Wiki {
            background: #351c75
        }

        .shop-買取ホムラ {
            background: #351c75
        }

        .shop-トゥインクル {
            background: #351c75
        }

        .shop-家電市場 {
            background: #351c75;
        }

        .shop-買取楽園 {
            background: #351c75
        }

        .shop-買取当番 {
            background: #351c75
        }

        .shop-携帯空間 {
            background: #351c75
        }

        .shop-ゲストモバイル {
            background: #351c75
        }

        .shop-買取オク {
            background: #351c75
        }

        .shop-毎日買取 {
            background: #351c75
        }

        .shop-MobileZone {
            background: #351c75
        }

        /* 旧名や表記ゆれ対策（末尾ハイフン表記にも色を適用）*/
        .shop-ドラゴンモバイル- {
            background: #351c75
        }

        .shop-モバステ- {
            background: #351c75
        }

        .shop-アキモバ- {
            background: #351c75
        }

        .is-hidden {
            display: none !important;
        }

        /* thead 高さ0指定 */
        table thead.thead-zero,
        table thead.thead-zero tr,
        table thead.thead-zero th,
        table thead[style*="height:0"],
        table thead[style*="height:0"] tr,
        table thead[style*="height:0"] th {
            height: 0 !important;
            padding: 0 !important;
            border: 0 !important;
            line-height: 0 !important;
            font-size: 0 !important;
            overflow: hidden !important;
            visibility: collapse !important;
        }

        table thead.thead-zero th::before,
        table thead[style*="height:0"] th::before {
            content: "";
            display: block;
            width: 100%;
            height: 0;
        }


    </style>
</head>
<body>

<div class="wrap">
    <fieldset>
        <legend>選択条件</legend>
        <div class="row4">
            <div>
                <label>時間（JST）</label>
            </div>
            <div>
                <input id="start" type="datetime-local" step="60">
            </div>
            <div>
                <button class="ghost" id="pick-time" type="button">選択時刻</button>
                <button class="ghost" id="latest" type="button">最新</button>
            </div>
            <div>

                <button class="ghost" id="clear-" type="button">画像保存</button>
                <button class="ghost" id="clear-a" type="button">Xへ公開</button>
            </div>
        </div>

        <legend>選択条件</legend>

        <div style="margin-top:10px">
            <label>店舗</label>
            <div id="shops"></div>
            <div class="btns" style="margin-top:8px">
                <button class="ghost" id="select-all-btn" type="button">すべて選択</button>
                <button class="ghost" id="clear-all-btn" type="button">すべて解除</button>
            </div>

            <div class="btns" style="margin-top:8px">
                <div>
                    <button class="ghost" id="do-not-display" type="button">非表示</button>
                    <button class="ghost" id="display-again" type="button">再表示</button>
                    <button class="ghost" id="replace-text" type="button">置換文字</button>
                    <button class="ghost" id="display-text" type="button">元文字</button>
                </div>
            </div>
        </div>
    </fieldset>

</div>


<div class="card">
    <h4 style="margin:1px 24px">iPhone17 買取相場 – 統合テンプレート</h4>
    <h4 id="main-title" style="margin:-1px 24px">iPhone17 買取相場20251006</h4>
    <h4 id="updated-at" style="margin:-1px 24px">更新日時：2025/10/6 13時00分</h4>

    <!-- ================= iPhone 17 Pro Max ================= -->
    <div class="model-section">
        <!--       <div class="model-header">iPhone 17 Pro Max</div> -->
        <table>
            <thead>
            <tr>
                <th class="col-model">機種</th>
                <th class="col-capacity">容量</th>
                <th class="col-num">定価</th>
                <th class="col-num">最高</th>
                <th class="col-num">差額</th>
                <th class="col-num">利益</th>
                <th class="col-num">前日比</th>
                <th class="col-num">平均値</th>
                <th class="col-color">カラー</th>
                <!-- Stores -->
                <th class="shop-col shop-head shop-買取商店">買取商店<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~18:00</p>
                    <p class="shop-date">(月火水木金　　　)</p>
                </th>


                <th class="shop-col shop-head shop-海峡通信">海峡通信<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">10:00~19:00</p>
                    <p class="shop-date">(月火水木金土日祝)</p>
                </th>
                <th class="shop-col shop-head shop-買取１丁目">買取<br>一丁目
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">10:00~19:00</p>
                    <p class="shop-date">(月火水木金土　　)</p>
                </th>
                <th class="shop-col shop-head shop-モバイルミックス">モバイル<br>ミックス
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:00</p>
                    <p class="shop-date">(月火水木金土　　)</p>
                </th>
                <th class="shop-col shop-head shop-森森買取">森森買取<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~20:00</p>
                    <p class="shop-date">(月火水木金土日祝)</p>
                </th>
                <th class="shop-col shop-head shop-買取ルデヤ">買取<br>ルデヤ
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:00</p>
                    <p class="shop-date">(月火水木金土　　)</p>
                </th>
                <th class="shop-col shop-head shop-買取Wiki">買取<br>Wiki
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">10:30~19:30</p>
                    <p class="shop-date">(月火水木金土日祝)</p>
                </th>
                <th class="shop-col shop-head shop-買取ホムラ">買取<br>ホムラ
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:00</p>
                    <p class="shop-date">(月火水木金土日祝)</p>
                </th>
                <th class="shop-col shop-head shop-ドラゴンモバイル-">ドラゴン<br>モバイル
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:30</p>
                    <p class="shop-date">(月火水木金土　　)</p>
                </th>
                <th class="shop-col shop-head shop-モバステ-">モバステ<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:30</p>
                    <p class="shop-date">(月火水木金土日祝)</p>
                </th>
                <th class="shop-col shop-head shop-アキモバ-">アキモバ<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">12:00~20:00</p>
                    <p class="shop-date">(月火水木金土　　)</p>
                </th>
                <th class="shop-col shop-head shop-トゥインクル">トゥイン<br>クル
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">10:30~19:30</p>
                    <p class="shop-date">(月火水木金土日祝)</p>
                </th>
                <th class="shop-col shop-head shop-家電市場">家電市場<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:00</p>
                    <p class="shop-date">(月火水木金　　　)</p>
                </th>
                <th class="shop-col shop-head shop-買取楽園">買取楽園<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">10:00~19:00</p>
                    <p class="shop-date">(月火水木金土　祝)</p>
                </th>
                <th class="shop-col shop-head shop-買取当番">買取当番<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:00</p>
                    <p class="shop-date">(月火水木金土　　)</p>
                </th>
                <th class="shop-col shop-head shop-携帯空間">携帯空間<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:00</p>
                    <p class="shop-date">(月火水木金土　祝)</p>
                </th>
                <th class="shop-col shop-head shop-ゲストモバイル">ゲストモ<br>バイル
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:30~19:00</p>
                    <p class="shop-date">(月火水木金　　　)</p>
                </th>
                <th class="shop-col shop-head shop-買取オク">買取オク<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">11:00~19:00</p>
                    <p class="shop-date">(月火水木金土　祝)</p>
                </th>
                <th class="shop-col shop-head shop-毎日買取">毎日買取<br>　
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">10:30~20:00</p>
                    <p class="shop-date">(月火水木金土日祝)</p>
                </th>
                <th class="shop-col shop-head shop-MobileZone">Mobile<br>Zone
                    <p class="shop-time">営業時間</p>
                    <p class="shop-time">10:00~18:00</p>
                    <p class="shop-date">(月火水木金土　祝)</p>
                </th>
            </tr>
            </thead>
            <tbody>
            <!-- 256GB -->
            <tr>
                <td rowspan="20" style="text-align:left;">iPhone 17 Pro Max</td>
                <td rowspan="5" style="text-align:left;">256GB</td>
                <td rowspan="5">194,800</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="20 21 22"
                    data-highest>
                    -
                </td>
                <td rowspan="5" data-diff>-</td>
                <td rowspan="5" data-rate>-</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="20 21 22"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="20 21 22"
                    data-average>
                    -
                </td>
            </tr>


            <tr>
                <td style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="21 22 20">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="21 22 20">※要問</td>
            </tr>

            <tr>
                <td style="background:#f68a44;text-align:left;">Orange</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="21">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="21">※要問</td>
            </tr>
            <tr>


                <td style="background:#4b5780;text-align:left;">Blue</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="22">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="22">※要問</td>
            </tr>
            <tr>


                <td style="background:#e6e6e6;text-align:left;">Silver</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="20">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="20">※要問</td>
            </tr>

            <!-- 512GB -->
            <tr>
                <td rowspan="5" style="text-align:left;">512GB</td>
                <td rowspan="5">229,800</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="23 24 25"
                    data-highest>
                    -
                </td>
                <td rowspan="5" data-diff>-</td>
                <td rowspan="5" data-rate>-</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="23 24 25"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="23 24 25"
                    data-average>
                    -
                </td>


            <tr class="avg-row">
                <td colspan="1" style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="24 25 23">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="24 25 23">※要問</td>
            </tr>

            <tr>
                <td style="background:#f68a44;text-align:left;">Orange</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="24">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="24">※要問</td>
            </tr>

            <tr>
                <td style="background:#4b5780;text-align:left;">Blue</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="25">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="25">※要問</td>
            </tr>

            <tr>
                <td style="background:#e6e6e6;text-align:left;">Silver</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="23">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="23">※要問</td>
            </tr>


            <!-- 1TB -->
            <tr>
                <td rowspan="5" style="text-align:left;">1TB</td>
                <td rowspan="5">264,800</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="26 27 28"
                    data-highest>
                    -
                </td>
                <td rowspan="5" data-diff>-</td>
                <td rowspan="5" data-rate>-</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="26 27 28"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="26 27 28"
                    data-average>
                    -
                </td>
            </tr>

            <tr class="avg-row">
                <td colspan="1" style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="1" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="8" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="13" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="7" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="9" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="10" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="19" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="18" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="16" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="12" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="17" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="3" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="4" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="2" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="5" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="11" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="6" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="15" iphen-average-id="27 28 26">※要問</td>
                <td class="nodata" data-shop-id="20" iphen-average-id="27 28 26">※要問</td>
            </tr>
            <tr>
                <td style="background:#f68a44;text-align:left;">Orange</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="27">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="27">※要問</td>
            </tr>
            <tr>

                <td style="background:#4b5780;text-align:left;">Blue</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="28">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="28">※要問</td>
            </tr>
            <tr>

                <td style="background:#e6e6e6;text-align:left;">Silver</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="26">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="26">※要問</td>
            </tr>
            <!-- 2TB -->
            <tr>
                <td rowspan="5" style="text-align:left;">2TB</td>
                <td rowspan="5">329,800</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="29 30 31"
                    data-highest>
                    -
                </td>
                <td rowspan="5" data-diff>-</td>
                <td rowspan="5" data-rate>-</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="29 30 31"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="29 30 31"
                    data-average>
                    -
                </td>
            </tr>
            <tr class="avg-row">
                <td colspan="1" style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="30 31 29">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="30 31 29">※要問</td>
            </tr>
            <tr>
                <td style="background:#f68a44;text-align:left;">Orange</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="30">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="30">※要問</td>
            </tr>
            <tr>

                <td style="background:#4b5780;text-align:left;">Blue</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="31">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="31">※要問</td>
            </tr>
            <tr>

                <td style="background:#e6e6e6;text-align:left;">Silver</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="29">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="29">※要問</td>
            </tr>


            </tbody>
        </table>
    </div>

    <div class="model-gap"></div>

    <!-- ================= iPhone 17 Pro ================= -->
    <div class="model-section">
        <!--       <div class="model-header">iPhone 17 Pro</div> -->
        <table>
            <thead class="thead-zero">
            <tr>
                <th class="col-model">機種</th>
                <th class="col-capacity">容量</th>
                <th class="col-num">定価</th>
                <th class="col-num">最高</th>
                　
                <th class="col-num">差額</th>
                <th class="col-num">買取率</th>
                <th class="col-num">平均値</th>
                <th class="col-num">前日比</th>
                <th class="col-color">カラー</th>
                <!-- Stores -->
                <th class="shop-col shop-head shop-買取商店">買取商店</th>
                <th class="shop-col shop-head shop-海峡通信">海峡通信</th>
                <th class="shop-col shop-head shop-買取１丁目">買取１丁目</th>
                <th class="shop-col shop-head shop-モバイルミックス">モバイルミックス</th>
                <th class="shop-col shop-head shop-森森買取">森森買取</th>
                <th class="shop-col shop-head shop-買取ルデヤ">買取ルデヤ</th>
                <th class="shop-col shop-head shop-買取Wiki">買取Wiki</th>
                <th class="shop-col shop-head shop-買取ホムラ">買取ホムラ</th>
                <th class="shop-col shop-head shop-ドラゴンモバイル-">ドラゴンモバイル-</th>
                <th class="shop-col shop-head shop-モバステ-">モバステ-</th>
                <th class="shop-col shop-head shop-アキモバ-">アキモバ-</th>
                <th class="shop-col shop-head shop-トゥインクル">トゥインクル</th>
                <th class="shop-col shop-head shop-家電市場">家電市場</th>
                <th class="shop-col shop-head shop-買取楽園">買取楽園</th>
                <th class="shop-col shop-head shop-買取当番">買取当番</th>
                <th class="shop-col shop-head shop-携帯空間">携帯空間</th>
                <th class="shop-col shop-head shop-ゲストモバイル">ゲストモバイル</th>
                <th class="shop-col shop-head shop-買取オク">買取オク</th>
                <th class="shop-col shop-head shop-毎日買取">毎日買取</th>
                <th class="shop-col shop-head shop-MobileZone">Mobile Zone</th>
            </tr>
            </thead>
            <tbody>
            <!-- 256GB -->
            <tr>
                <td rowspan="15" style="text-align:left;">iPhone 17 Pro</td>
                <td rowspan="5" style="text-align:left;">256GB</td>
                <td rowspan="5">179,800</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="11 12 13"
                    data-highest>
                    -
                </td>
                <td rowspan="5" data-diff>-</td>
                <td rowspan="5" data-rate>-</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="11 12 13"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="11 12 13"
                    data-average>
                    -
                </td>
            </tr>


            <tr class="avg-row">
                <td colspan="1" style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="12 13 11">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="12 13 11">※要問</td>
            </tr>

            <tr>
                <td style="background:#f68a44;text-align:left;">Orange</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="12">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="12">※要問</td>
            </tr>
            <tr>


                <td style="background:#4b5780;text-align:left;">Blue</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="13">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="13">※要問</td>
            </tr>
            <tr>


                <td style="background:#e6e6e6;text-align:left;">Silver</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="11">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="11">※要問</td>
            </tr>

            <!-- 512GB -->
            <tr>
                <td rowspan="5" style="text-align:left;">512GB</td>
                <td rowspan="5">214,800</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="14 15 16"
                    data-highest>
                    -
                </td>
                <td rowspan="5" data-diff>-</td>
                <td rowspan="5" data-rate>-</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="14 15 16"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="14 15 16"
                    data-average>
                    -
                </td>
            </tr>

            <tr class="avg-row">
                <td colspan="1" style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="15 16 14">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="15 16 14">※要問</td>
            </tr>
            <tr>
                <td style="background:#f68a44;text-align:left;">Orange</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="15">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="15">※要問</td>
            </tr>


            <tr>
                <td style="background:#4b5780;text-align:left;">Blue</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="16">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="16">※要問</td>
            </tr>
            <tr>


                <td style="background:#e6e6e6;text-align:left;">Silver</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="14">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="14">※要問</td>
            </tr>
            <!-- 1TB -->
            <tr>
                <td rowspan="5" style="text-align:left;">1TB</td>
                <td rowspan="5">249,800</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="17 18 19"
                    data-highest>
                    -
                </td>
                <td rowspan="5" data-diff>-</td>
                <td rowspan="5" data-rate>-</td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="17 18 19"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="5"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="17 18 19"
                    data-average>
                    -
                </td>
            </tr>
            <tr class="avg-row">
                <td colspan="1" style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="18 19 17">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="18 19 17">※要問</td>
            </tr>

            <tr>
                <td style="background:#f68a44;text-align:left;">Orange</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="18">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="18">※要問</td>
            </tr>

            <tr>
                <td style="background:#4b5780;text-align:left;">Blue</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="19">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="19">※要問</td>
            </tr>

            <tr>
                <td style="background:#e6e6e6;text-align:left;">Silver</td>
                <td class="nodata" data-shop-id="14" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-id="17">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-id="17">※要問</td>
            </tr>


            </tbody>
        </table>
    </div>

    <div class="model-gap"></div>


    <!-- ================= iPhone Air ================= -->
    <div class="model-section">
        <!--       <div class="model-header">iPhone Air</div> -->
        <table>
            <thead style='height:0'>
            <tr>
                <th class="col-model">機種</th>
                <th class="col-capacity">容量</th>
                <th class="col-num">定価</th>
                <th class="col-num">最高</th>
                　
                <th class="col-num">差額</th>
                <th class="col-num">買取率</th>
                <th class="col-num">平均値</th>
                <th class="col-num">前日比</th>
                <th class="col-color">カラー</th>
                <!-- Stores -->
                <th class="shop-col shop-head shop-買取商店">買取商店</th>
                <th class="shop-col shop-head shop-海峡通信">海峡通信</th>
                <th class="shop-col shop-head shop-買取１丁目">買取１丁目</th>
                <th class="shop-col shop-head shop-モバイルミックス">モバイルミックス</th>
                <th class="shop-col shop-head shop-森森買取">森森買取</th>
                <th class="shop-col shop-head shop-買取ルデヤ">買取ルデヤ</th>
                <th class="shop-col shop-head shop-買取Wiki">買取Wiki</th>
                <th class="shop-col shop-head shop-買取ホムラ">買取ホムラ</th>
                <th class="shop-col shop-head shop-ドラゴンモバイル-">ドラゴンモバイル-</th>
                <th class="shop-col shop-head shop-モバステ-">モバステ-</th>
                <th class="shop-col shop-head shop-アキモバ-">アキモバ-</th>
                <th class="shop-col shop-head shop-トゥインクル">トゥインクル</th>
                <th class="shop-col shop-head shop-家電市場">家電市場</th>
                <th class="shop-col shop-head shop-買取楽園">買取楽園</th>
                <th class="shop-col shop-head shop-買取当番">買取当番</th>
                <th class="shop-col shop-head shop-携帯空間">携帯空間</th>
                <th class="shop-col shop-head shop-ゲストモバイル">ゲストモバイル</th>
                <th class="shop-col shop-head shop-買取オク">買取オク</th>
                <th class="shop-col shop-head shop-毎日買取">毎日買取</th>
                <th class="shop-col shop-head shop-MobileZone">Mobile Zone</th>
            </tr>
            </thead>

            <tbody>
            <tr>

                <td rowspan="3" style="text-align:left;">iPhone Air</td>
                <td style="text-align:left;">256GB</td>
                <td rowspan="1">159,800</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="32 33 34 35"
                    data-highest>
                    -
                </td>
                <td rowspan="1" data-diff>-</td>
                <td rowspan="1" data-rate>-</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="32 33 34 35"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="32 33 34 35"
                    data-average>
                    -
                </td>
                <td style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="32 33 34 35">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="32 33 34 35">※要問</td>
            </tr>

            <tr>
                <td style="text-align:left;">512GB</td>
                <td rowspan="1">194,800</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="36 37 38 39"
                    data-highest>
                    -
                </td>
                <td rowspan="1" data-diff>-</td>
                <td rowspan="1" data-rate>-</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="36 37 38 39"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="36 37 38 39"
                    data-average>
                    -
                </td>
                <td style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="36 37 38 39">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="36 37 38 39">※要問</td>
            </tr>

            <tr>
                <td style="text-align:left;">1T</td>
                <td rowspan="1">229,800</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="40 41 42 43"
                    data-highest>
                    -
                </td>
                <td rowspan="1" data-diff>-</td>
                <td rowspan="1" data-rate>-</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="40 41 42 43"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="40 41 42 43"
                    data-average>
                    -
                </td>
                <td style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="40 41 42 43">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="40 41 42 43">※要問</td>
            </tr>


            </tbody>
        </table>
    </div>


    <!-- ================= iPhone 17 ================= -->
    <div class="model-section">
        <!--       <div class="model-header">iPhone 17</div> -->
        <table>
            <thead class="thead-zero">
            <tr>
                <th class="col-model">機種</th>
                <th class="col-capacity">容量</th>
                <th class="col-num">定価</th>
                <th class="col-num">最高</th>
                　
                <th class="col-num">差額</th>
                <th class="col-num">買取率</th>
                <th class="col-num">平均値</th>
                <th class="col-num">前日比</th>
                <th class="col-color">カラー</th>
                <!-- Stores -->
                <th class="shop-col shop-head shop-買取商店">買取商店</th>
                <th class="shop-col shop-head shop-海峡通信">海峡通信</th>
                <th class="shop-col shop-head shop-買取１丁目">買取１丁目</th>
                <th class="shop-col shop-head shop-モバイルミックス">モバイルミックス</th>
                <th class="shop-col shop-head shop-森森買取">森森買取</th>
                <th class="shop-col shop-head shop-買取ルデヤ">買取ルデヤ</th>
                <th class="shop-col shop-head shop-買取Wiki">買取Wiki</th>
                <th class="shop-col shop-head shop-買取ホムラ">買取ホムラ</th>
                <th class="shop-col shop-head shop-ドラゴンモバイル-">ドラゴンモバイル-</th>
                <th class="shop-col shop-head shop-モバステ-">モバステ-</th>
                <th class="shop-col shop-head shop-アキモバ-">アキモバ-</th>
                <th class="shop-col shop-head shop-トゥインクル">トゥインクル</th>
                <th class="shop-col shop-head shop-家電市場">家電市場</th>
                <th class="shop-col shop-head shop-買取楽園">買取楽園</th>
                <th class="shop-col shop-head shop-買取当番">買取当番</th>
                <th class="shop-col shop-head shop-携帯空間">携帯空間</th>
                <th class="shop-col shop-head shop-ゲストモバイル">ゲストモバイル</th>
                <th class="shop-col shop-head shop-買取オク">買取オク</th>
                <th class="shop-col shop-head shop-毎日買取">毎日買取</th>
                <th class="shop-col shop-head shop-MobileZone">Mobile Zone</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td rowspan="2" style="text-align:left;">iPhone 17</td>
                <td style="text-align:left;">256GB</td>
                <td rowspan="1">129,800</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="1 2 3 4 5"
                    data-highest>
                    -
                </td>
                <td rowspan="1" data-diff>-</td>
                <td rowspan="1" data-rate>-</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="1 2 3 4 5"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="1 2 3 4 5"
                    data-average>
                    -
                </td>

                <td style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="1 2 3 4 5">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="1 2 3 4 5">※要問</td>
            </tr>

            <tr>
                <td style="text-align:left;">512GB</td>
                <td rowspan="1">164,800</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="6 7 8 9 10"
                    data-highest>
                    -
                </td>
                <td rowspan="1" data-diff>-</td>
                <td rowspan="1" data-rate>-</td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="6 7 8 9 10"
                    data-change-from-crevious-day>-
                </td>
                <td rowspan="1"
                    data-range-shop-id="14 1 8 13 7 9 10 19 18 16 12 17 3 4 2 5 11 5 15 20"
                    data-range-iphen-id="6 7 8 9 10"
                    data-average>
                    -
                </td>
                <td style="text-align:left;">ALL</td>
                <td class="nodata" data-shop-id="14" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="1" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="8" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="13" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="7" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="9" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="10" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="19" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="18" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="16" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="12" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="17" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="3" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="4" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="2" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="5" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="11" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="6" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="15" data-iphen-average-id="6 7 8 9 10">※要問</td>
                <td class="nodata" data-shop-id="20" data-iphen-average-id="6 7 8 9 10">※要問</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="model-gap"></div>


</div>
<details style="margin:30px">
    <summary class="muted">店舗ごとの件数／フィルタ後件数／開始・終了時刻）</summary>
</details>
<script>
    (() => {

        const SHOP_COLOR_RULES = [
            {match: /買取商店/, color: "#DD1133", shop_id: 14, order: 1},
            {match: /海峡通信/, color: "#478CD8", shop_id: 1, order: 2},
            {match: /買取一丁目/, color: "#B41524", shop_id: 8, order: 3},
            {match: /モバイルミックス/, color: "#DD1133", shop_id: 13, order: 4},
            {match: /森森買取/, color: "#278C46", shop_id: 7, order: 5},
            {match: /買取ルデヤ/, color: "#2DA9E8", shop_id: 9, order: 6},
            {match: /買取wiki/, color: "#E71534", shop_id: 10, order: 7},
            {match: /買取ホムラ/, color: "#F27474", shop_id: 19, order: 8},
            {match: /ドラゴンモバイル/, color: "#3952A6", shop_id: 16, order: 9},
            {match: /モバステ/, color: "#E60012", shop_id: 18, order: 10},
            {match: /アキモバ/, color: "#20AECC", shop_id: 12, order: 11},
            {match: /トゥインクル/, color: "#0EC7D9", shop_id: 17, order: 12},
            {match: /家電市場/, color: "#FFF100", shop_id: 3, order: 13},
            {match: /買取楽園/, color: "#DA7C66", shop_id: 4, order: 14},
            {match: /買取当番/, color: "#1C4473", shop_id: 2, order: 15},
            {match: /携帯空間/, color: "#0049A8", shop_id: 5, order: 16},
            {match: /ゲストモバイル/, color: "#34C6F6", shop_id: 11, order: 17},
            {match: /買取オク/, color: "#033F68", shop_id: 6, order: 18},
            {match: /毎日買取/, color: "#C30D23", shop_id: 15, order: 19},
            {match: /Mobile Zone/, color: "#f50620", shop_id: 20, order: 20},
        ];

        const API_BASE = '/AppleStockChecker';
        const ENDPOINT_SHOPS = `${API_BASE}/secondhand-shops/`;
        const SHOPS_INDEX = new Map(); // shopId -> shopName

        // ---------- Helpers ----------
        const $id = (id) => document.getElementById(id);
        const $q = (sel, root = document) => root.querySelector(sel);
        const $qa = (sel, root = document) => Array.from(root.querySelectorAll(sel));

        // 注入样式：极值标注 & 隐藏列
        (function injectStyles() {
            if ($id('psta-row-styles')) return;
            const css = `
      .psta-max   { background:#d9fbe5 !important; color:#b42318 !important; } /* 最高：绿底+红字 */
      .psta-min   { color:#b42318 !important; }                                 /* 最低：红字 */
      .psta-close { background:#d9fbe5 !important; }                             /* 最接近平均：绿底 */
      .is-hidden  { display:none !important; }                                   /* 列隐藏 */
    `;
            const style = document.createElement('style');
            style.id = 'psta-row-styles';
            style.textContent = css;
            document.head.appendChild(style);
        })();

        // ---------- 服务器ID -> 本地ID（可选映射） ----------
        const SERVER_TO_LOCAL_SHOP = {
            7: 11, 10: 12, 16: 13, 12: 14, 21: 15, 9: 16, 8: 17, 1: 18,
            14: 19, 18: 20, 17: 21, 4: 22, 2: 23, 5: 24, 11: 25, 6: 26,
            15: 27, 13: 28
        };
        const SERVER_TO_LOCAL_IPHEN = {
            1: 143, 2: 144, 3: 145, 4: 146, 5: 147, 6: 148, 7: 149, 8: 150, 9: 151, 10: 152,
            11: 153, 12: 154, 13: 155, 14: 156, 15: 157, 16: 158, 17: 159, 18: 160, 19: 161, 20: 162,
            21: 163, 22: 164, 23: 165, 24: 166, 25: 167, 26: 168, 27: 169, 28: 170, 29: 171, 30: 172,
            31: 173, 32: 174, 33: 175, 34: 176, 35: 177, 36: 178, 37: 179, 38: 180, 39: 181, 40: 182,
            41: 183, 42: 184, 43: 185
        };


        // rows: fetchRows(start, end) 的返回数组（服务器ID）
// 返回：Map key="shopKey-iphoneKey" -> 该时间窗内的最高价
        function buildMaxInWindow(rows) {
            const m = new Map();
            for (const x of rows) {
                const sKey = serverToMatchShop(Number(x.shop_id));
                const iKey = serverToMatchIphen(Number(x.iphone_id));
                if (!Number.isFinite(sKey) || !Number.isFinite(iKey)) continue;
                const k = `${sKey}-${iKey}`;
                const price = Number(x.New_Product_Price);
                if (!Number.isFinite(price)) continue;
                const cur = m.get(k);
                if (cur == null || price > cur) m.set(k, price);
            }
            return m;
        }


        const RULE_INDEX_BY_ID = new Map(
            (Array.isArray(SHOP_COLOR_RULES) ? SHOP_COLOR_RULES : []).map(r => [String(r.shop_id), r])
        );

        function findRuleForShop(sname, sid) {
            const name = String(sname ?? '').trim();
            // 名字优先：把规则里的正则强制成忽略大小写匹配
            const byName = SHOP_COLOR_RULES.find(r => {
                try {
                    return new RegExp(r.match.source, 'i').test(name);
                } catch {
                    return false;
                }
            });
            if (byName) return byName;

            // 兜底：按 shop_id 匹配
            const byId = RULE_INDEX_BY_ID.get(String(sid));
            return byId || null;
        }

        // helper: 从 tr 中找定価（扫描到第一组店铺列前的最后一个数字单元格）
// 返回 Number 或 NaN
        function findBasePriceInRow(tr) {
            if (!tr) return NaN;
            const tds = Array.from(tr.querySelectorAll('td'));
            let lastNum = NaN;
            for (const td of tds) {
                // 遇到第一个店铺列就停止（后续是各店铺数据）
                if (td.hasAttribute('data-shop-id')) break;
                const v = parseNumText(td.textContent);
                if (Number.isFinite(v)) lastNum = v;
            }
            return Number.isFinite(lastNum) ? lastNum : NaN;
        }

// 根据规则（< 50% 定価）过滤 closest Map：
// - 会返回一个新的 Map（没有被过滤的 entries）
// - 并把对应的 DOM 单元格也标为 nodata / 显示 "※要問"（方便视觉）
        function filterOutBelowHalf(closest) {
            const res = new Map();
            for (const [key, val] of closest.entries()) {
                // key 形式为 "sKey-iKey"（使用的是 match ID，即 serverToMatch... 的结果）
                const [sKeyStr, iKeyStr] = String(key).split('-');
                const sKey = Number(sKeyStr), iKey = Number(iKeyStr);
                if (!Number.isFinite(sKey) || !Number.isFinite(iKey)) continue;

                // 在 DOM 中找到与之对应的任一 td（用服务器ID -> matchID 的匹配关系来找）
                // 因为 DOM 存的是服务器ID，我们用 serverToMatchShop(serverId) === sKey 来匹配
                const candidateTd = Array.from(document.querySelectorAll('td[data-shop-id][data-iphen-id]'))
                    .find(td => {
                        const srv = Number(td.getAttribute('data-shop-id'));
                        const iph = Number(td.getAttribute('data-iphen-id'));
                        return Number.isFinite(srv) && Number.isFinite(iph) &&
                            serverToMatchShop(srv) === sKey && serverToMatchIphen(iph) === iKey;
                    });

                // 如果能找到对应的 tr，就从 tr 中解析定価并判定是否低于 50%
                if (candidateTd) {
                    const tr = candidateTd.parentElement;
                    const basePrice = findBasePriceInRow(tr);
                    if (Number.isFinite(basePrice)) {
                        if (Number(val.price) < basePrice * 0.5) {
                            // 判定为异常，标为 nodata：清 dataset.v，显示 ※要問
                            candidateTd.dataset.v = '';
                            candidateTd.textContent = '※要問';
                            candidateTd.classList.add('nodata');
                            // 不把此 entry 放入 res（即从参与计算的数据中剔除）
                            continue;
                        }
                    }
                }
                // 否则保留 entry（包括没找到 DOM 对应或没有 basePrice 的情况）
                res.set(key, val);
            }
            return res;
        }

        // 根据 endBase（通常是你这次运算的 end 时间）计算“昨日18:00~20:10(JST)”
        // 然后对页面所有 [data-change-from-crevious-day] 单元格写入前日比
        async function fillChangeFromPreviousDay(endBase) {
            // —— 1) 生成昨日窗口 —— //
            // 以 Asia/Tokyo 为准：直接用本地 Date 减一天并设定固定时刻即可
            const y = new Date(endBase.getTime()); // copy
            y.setDate(y.getDate() - 1);

            // 昨日 18:00
            const startPrev = new Date(y.getFullYear(), y.getMonth(), y.getDate(), 18, 0, 0);
            // 昨日 20:10
            const endPrev = new Date(y.getFullYear(), y.getMonth(), y.getDate(), 20, 10, 0);

            // —— 2) 拉取昨日窗口数据，一次请求供全表使用 —— //
            const rowsPrev = await fetchRows(startPrev, endPrev);
            const maxPrevMap = buildMaxInWindow(rowsPrev); // key = "shopKey-iphoneKey" -> 最高价

            // —— 3) 遍历需要填写“前日比”的格子 —— //
            const changeCells = document.querySelectorAll(
                'td[data-change-from-crevious-day][data-range-shop-id][data-range-iphen-id]'
            );

            let done = 0;
            changeCells.forEach(cell => {
                const tr = cell.parentElement;

                // a) 解析本格子的店铺/机型集合（DOM存的是服务器ID；用映射得到匹配ID）
                const shopsSrv = (cell.getAttribute('data-range-shop-id') || '').trim().split(/\s+/).map(Number).filter(Number.isFinite);
                const iphsSrv = (cell.getAttribute('data-range-iphen-id') || '').trim().split(/\s+/).map(Number).filter(Number.isFinite);
                const shopsKey = [...new Set(shopsSrv.map(serverToMatchShop))];
                const iphsKey = [...new Set(iphsSrv.map(serverToMatchIphen))];

                // b) 在昨日窗口里，找出这些组合的“最高价”（跨店/跨机型取最大）
                let prevMax = null;
                for (const s of shopsKey) {
                    for (const i of iphsKey) {
                        const k = `${s}-${i}`;
                        const p = maxPrevMap.get(k);
                        if (Number.isFinite(p)) {
                            if (prevMax == null || p > prevMax) prevMax = p;
                        }
                    }
                }

                // c) 找当前行的“平均值”单元格（你前面已写入 dataset.v）
                const avgCell = tr.querySelector('td[data-average][data-range-shop-id][data-range-iphen-id]') ||
                    tr.querySelector('td[data-average]');
                const avgNow = avgCell ? Number(avgCell.dataset.v) : NaN;

                // d) 计算差值并显示
                if (prevMax != null && Number.isFinite(avgNow)) {
                    const diff = avgNow - prevMax;                      // 方向：当前均值 - 昨日窗最高
                    cell.dataset.v = String(diff);
                    cell.textContent = (diff > 0 ? `+${new Intl.NumberFormat('ja-JP').format(diff)}`
                        : new Intl.NumberFormat('ja-JP').format(diff));
                    cell.style.color = diff > 0 ? '#2727ff' : (diff < 0 ? '#b42318' : '');
                    done++;
                } else {
                    cell.dataset.v = '';
                    cell.textContent = '-';
                    cell.style.color = '';
                }
            });

            console.log(`[PSTA] change-from-previous-day filled for ${done}/${changeCells.length} cell(s).`);
        }

        // ---------- 极值标注（兼容 iphen-id / iphen-average-id / data-iphen-average-id） ----------
        function highlightRowExtremes() {
            // 兼容 data-iphone-id 与 data-iphen-id
            const ROW_SHOP_CELL_SEL = 'td[data-shop-id][data-iphone-id], td[data-shop-id][data-iphen-id]';
            let affected = 0;

            // 将单元格解析为数值（去掉逗号/货币等；※要問/nodata/隐藏替换 一律跳过）
            const parseCellNumber = (td) => {
                if (!td || !(td instanceof HTMLElement)) return null;
                if (td.classList.contains('nodata')) return null;
                if (td.dataset.hidden === '1' || td.dataset.replaced === '1') return null;
                const raw = td.dataset?.v ?? td.textContent ?? '';
                const s = String(raw).trim();
                if (!s || s === '※要問' || s === '—' || s === '-' || s.toLowerCase() === 'n/a') return null;
                const n = Number(s.replace(/[,\s¥円]/g, ''));
                return Number.isFinite(n) ? n : null;
            };

            document.querySelectorAll('tr').forEach(tr => {
                const cells = Array.from(tr.querySelectorAll(ROW_SHOP_CELL_SEL));
                if (!cells.length) return;

                // 先清除旧标记（仅店铺格）
                cells.forEach(td => td.classList.remove('psta-max', 'psta-min', 'psta-close'));

                // 收集有效数字
                const items = [];
                for (const td of cells) {
                    const v = parseCellNumber(td);
                    if (v != null) items.push({td, v});
                }
                if (!items.length) return;

                // 行内平均：优先取本行 data-average（若有），否则求平均
                let avgVal = NaN;
                const avgCell = tr.querySelector('td[data-average]');
                if (avgCell) {
                    const avg = parseCellNumber(avgCell);
                    if (avg != null) avgVal = avg;
                }
                if (!Number.isFinite(avgVal)) {
                    avgVal = items.reduce((s, x) => s + x.v, 0) / items.length;
                }

                // 正确计算极值（注意属性名是 .v）
                const nums = items.map(x => x.v);
                const maxVal = Math.max(...nums); // 行内最大
                const minVal = Math.min(...nums); // 行内最小

                // 距平均最近的差值（允许并列）
                let bestDiff = Infinity;
                for (const it of items) {
                    const d = Math.abs(it.v - avgVal);
                    if (d < bestDiff) bestDiff = d;
                }

                // 打标（你的样式里 psta-max/psta-min/psta-close 需已定义）
                for (const it of items) {
                    if (it.v === maxVal) it.td.classList.add('psta-max'); // 最高
                    if (it.v === minVal) it.td.classList.add('psta-min'); // 最低
                    // 若需要标“最接近平均”的格，取消注释下一行
                    // if (Math.abs(it.v - avgVal) === bestDiff) it.td.classList.add('psta-close');
                }

                affected++;
            });

            console.log(`[PSTA] row extremes highlighted on ${affected} row(s).`);
        }

        // ---------- 本地映射开关 ----------
        const LS_KEY = 'useLocalIdMap';
        const isMappingEnabled = () => localStorage.getItem(LS_KEY) === 'true';
        const setMappingEnabled = v => localStorage.setItem(LS_KEY, v ? 'true' : 'false');

        function injectToggle() {
            const fieldset = document.querySelector('fieldset legend')?.parentElement || document.body;
            const container = document.createElement('div');
            Object.assign(container.style, {
                display: 'inline-flex',
                alignItems: 'center',
                gap: '8px',
                marginLeft: '12px'
            });

            const label = document.createElement('label');
            label.style.cursor = 'pointer';
            label.title = '开启：DOM中的服务器ID将映射为本地ID再匹配（本地调试用）';

            const cb = document.createElement('input');
            cb.type = 'checkbox';
            cb.id = 'toggle-local-map';
            cb.checked = isMappingEnabled();

            const span = document.createElement('span');
            span.textContent = '本地ID映射';
            span.style.userSelect = 'none';

            label.appendChild(cb);
            label.appendChild(span);
            container.appendChild(label);

            const btnArea = fieldset.querySelector('.row4 > div:nth-child(3)') || fieldset;
            btnArea.appendChild(container);

            cb.addEventListener('change', () => {
                setMappingEnabled(cb.checked);
                console.log('[PSTA] Local ID Mapping =', cb.checked);
            });
        }

        injectToggle();

        // ---------- DOM 钩子（有就绑；没有就跳过） ----------
        const input = $id('start');            // <input type="datetime-local" id="start">
        const btnPick = $id('pick-time');        // 「選択時刻」按钮（可选）
        const btnNew = $id('latest');           // 「最新」按钮（可选）
        const caption = $id('range-caption');    // 可选
        const updatedAtEl = $id('updated-at');       // 可选

        // ---------- 时间 & 请求 ----------
        const fmt = new Intl.DateTimeFormat('sv-SE', {
            year: 'numeric', month: '2-digit', day: '2-digit',
            hour: '2-digit', minute: '2-digit', second: '2-digit',
            hour12: false, timeZone: 'Asia/Tokyo'
        });
        const toIsoTZ = d => fmt.format(d).replace(' ', 'T') + '+09:00';
        const enc = encodeURIComponent;
        const floorToMinute = d => new Date(Math.floor(d.getTime() / 60000) * 60000);

        function formatDisplayJP(d) {
            const z = new Intl.DateTimeFormat('ja-JP', {
                timeZone: 'Asia/Tokyo', year: 'numeric', month: '2-digit', day: '2-digit',
                hour: '2-digit', minute: '2-digit', hour12: false
            }).formatToParts(d).reduce((acc, p) => (acc[p.type] = p.value, acc), {});
            return `${z.year}/${z.month}/${z.day} ${z.hour}時${z.minute}分`;
        }

        async function fetchRows(start, end) {
            const url = `${API_BASE}/purchasing-time-analyses-psta-compact/?start=${enc(toIsoTZ(start))}&end=${enc(toIsoTZ(end))}`;
            const r = await fetch(url, {headers: {'Accept': 'application/json'}});
            if (!r.ok) throw new Error(`HTTP ${r.status}`);
            return r.json();
        }

        function buildClosestByRef(rows, refTs) {
            const m = new Map(); // key `${shop}-${iphone}`
            for (const x of rows) {
                const k = `${x.shop_id}-${x.iphone_id}`;
                const ts = Date.parse(x.Timestamp_Time);
                if (!Number.isFinite(ts)) continue;
                const cur = m.get(k);
                if (!cur || Math.abs(ts - refTs) < Math.abs(cur.ts - refTs)) {
                    m.set(k, {price: x.New_Product_Price, ts});
                }
            }
            return m;
        }

        const serverToMatchShop = id => isMappingEnabled() ? (SERVER_TO_LOCAL_SHOP[id] ?? id) : id;
        const serverToMatchIphen = id => isMappingEnabled() ? (SERVER_TO_LOCAL_IPHEN[id] ?? id) : id;

        const nfJPY = new Intl.NumberFormat('ja-JP');
        const nfPct = new Intl.NumberFormat('ja-JP', {style: 'percent', maximumFractionDigits: 0});
        const formatWithPlus = v => (v > 0 ? `+${nfJPY.format(v)}` : nfJPY.format(v));

        const parseIds = s => [...new Set(String(s || '').trim().split(/\s+/).map(Number).filter(Number.isFinite))];
        const parseNumText = t => {
            const n = Number(String(t || '').replace(/[^\d.-]/g, ''));
            return Number.isFinite(n) ? n : NaN;
        };

        // ---------- 单值/平均（格子级） ----------
        function fillSingles(closest) {
            const cells = document.querySelectorAll('td[data-shop-id][data-iphen-id]');
            let ok = 0;
            for (const td of cells) {
                const sSrv = Number(td.dataset.shopId);
                const iSrv = Number(td.dataset.iphenId);
                const sKey = serverToMatchShop(sSrv);
                const iKey = serverToMatchIphen(iSrv);
                const rec = closest.get(`${sKey}-${iKey}`);
                if (rec && Number.isFinite(rec.price)) {
                    td.dataset.v = String(rec.price);
                    td.textContent = nfJPY.format(rec.price);
                    td.classList.remove('nodata');
                    ok++;
                } else {
                    td.dataset.v = '';
                    td.textContent = '※要問';
                    td.classList.add('nodata');

                }
            }
            console.log(`[PSTA] singles filled: ${ok}/${cells.length} (map=${isMappingEnabled()})`);
        }

        function fillSinglesSelective(closest, shopIdSet) {
            const cells = document.querySelectorAll('td[data-shop-id][data-iphen-id]');
            let ok = 0;
            for (const td of cells) {
                const sSrv = Number(td.dataset.shopId);
                if (!shopIdSet.has(sSrv)) continue;
                if (td.dataset.v) continue;
                const iSrv = Number(td.dataset.iphenId);
                const sKey = serverToMatchShop(sSrv);
                const iKey = serverToMatchIphen(iSrv);
                const rec = closest.get(`${sKey}-${iKey}`);
                if (rec && Number.isFinite(rec.price)) {
                    td.dataset.v = String(rec.price);
                    td.textContent = nfJPY.format(rec.price);
                    td.classList.remove('nodata');
                    ok++;
                }
            }
            console.log(`[PSTA] singles backfilled for ${ok} cell(s) across ${shopIdSet.size} shop(s).`);
        }

        const toHundredsFloor = v => Math.floor(v / 100) * 100; // 百位以下舍去
        const toHundredsRound = v => Math.round(v / 100) * 100; // 百位以下四舍五入

        function fillAverages(closest) {
            const cells = document.querySelectorAll('td[data-shop-id][data-iphen-average-id], td[data-shop-id][iphen-average-id]');
            let ok = 0;
            for (const td of cells) {
                const sSrv = Number(td.dataset.shopId);
                const raw = td.getAttribute('data-iphen-average-id') || td.getAttribute('iphen-average-id') || '';
                const iSrvList = parseIds(raw);
                const sKey = serverToMatchShop(sSrv);
                const iKeys = [...new Set(iSrvList.map(serverToMatchIphen))];

                let sum = 0, n = 0;
                for (const iKey of iKeys) {
                    const rec = closest.get(`${sKey}-${iKey}`);
                    if (rec && Number.isFinite(rec.price)) {
                        sum += rec.price;
                        n++;
                    }
                }
                if (n) {
                    const avg = Math.round(sum / n);
                    const avg100 = toHundredsRound(avg);
                    td.dataset.v = String(avg100);
                    td.textContent = nfJPY.format(avg100);
                    td.classList.remove('nodata');
                    ok++;
                } else {
                    td.dataset.v = '';
                    td.textContent = '※要問';
                }
            }
            console.log(`[PSTA] averages filled: ${ok}/${cells.length} (map=${isMappingEnabled()})`);
        }

        // ---------- 行级：B/C/D/E ----------
        function recalcRangeCells(closest) {
            let rowsDone = 0;

            document.querySelectorAll('td[data-highest][data-range-shop-id][data-range-iphen-id]').forEach(highCell => {
                const tr = highCell.parentElement;

                const shopsSrv = parseIds(highCell.dataset.rangeShopId);
                const iphsSrv = parseIds(highCell.dataset.rangeIphenId);
                const shopsKey = [...new Set(shopsSrv.map(serverToMatchShop))];
                const iphsKey = [...new Set(iphsSrv.map(serverToMatchIphen))];

                const vals = [];
                for (const s of shopsKey) {
                    for (const i of iphsKey) {
                        const rec = closest.get(`${s}-${i}`);
                        if (rec && Number.isFinite(rec.price)) vals.push(rec.price);
                    }
                }

                const highest = vals.length ? Math.max(...vals) : null;
                const average = vals.length ? Math.round(vals.reduce((a, b) => a + b, 0) / vals.length) : null;

                // 最高（B）
                if (highest != null) {
                    highCell.dataset.v = String(highest);
                    highCell.textContent = nfJPY.format(highest);
                } else {
                    highCell.dataset.v = '';
                    highCell.textContent = '-';
                }

                // 定価：假设为 highCell 前一个 <td>
                const baseCell = highCell.previousElementSibling;
                const basePrice = baseCell ? parseNumText(baseCell.textContent) : NaN;

                // 差額（C）= highest - 定価
                const diffCell = tr.querySelector('td[data-diff]');
                if (diffCell) {
                    if (highest != null && Number.isFinite(basePrice)) {
                        const diffVal = highest - basePrice;
                        diffCell.dataset.v = String(diffVal);
                        diffCell.textContent = formatWithPlus(diffVal);
                        diffCell.style.color = diffVal > 0 ? '#2727ff' : (diffVal < 0 ? '#b42318' : '');
                    } else {
                        diffCell.dataset.v = '';
                        diffCell.textContent = '-';
                        diffCell.style.color = '';
                    }
                }

                // 買取率（D）= highest / 定価
                const diffCell2 = tr.querySelector('td[data-rate]');
                if (diffCell2) {
                    if (highest != null && Number.isFinite(basePrice)) {
                        const diffVal = highest - basePrice;
                        diffCell2.dataset.v = String(diffVal);
                        diffCell2.textContent = formatWithPlus(diffVal);
                        diffCell2.style.color = diffVal > 0 ? '#2727ff' : (diffVal < 0 ? '#b42318' : '');
                    } else {
                        diffCell2.dataset.v = '';
                        diffCell2.textContent = '-';
                        diffCell2.style.color = '';
                    }
                }

                // 平均（E）
                const avgCell = tr.querySelector('td[data-average][data-range-shop-id][data-range-iphen-id]') ||
                    tr.querySelector('td[data-average]');
                if (avgCell) {
                    if (average != null) {
                        avgCell.dataset.v = String(average);
                        avgCell.textContent = nfJPY.format(average);
                    } else {
                        avgCell.dataset.v = '';
                        avgCell.textContent = '-';
                    }
                }

                rowsDone++;
            });

            console.log(`[PSTA] range highest/diff/rate/average recalculated for ${rowsDone} row(s).`);
        }

        // ---------- 缺失店铺识别 & Map 合并 ----------
        function getShopsWithNoAnyData() {
            const shops = new Map(); // sSrv -> { total, hasValue }
            const cells = document.querySelectorAll('td[data-shop-id][data-iphen-id]');
            for (const td of cells) {
                const sSrv = Number(td.dataset.shopId);
                const st = shops.get(sSrv) || {total: 0, hasValue: false};
                st.total += 1;
                if (td.dataset.v) st.hasValue = true;
                shops.set(sSrv, st);
            }
            const missing = [...shops.entries()]
                .filter(([, st]) => st.total > 0 && !st.hasValue)
                .map(([sSrv]) => sSrv);
            return new Set(missing);
        }

        function mergeClosestMaps(primary, fallback) {
            const res = new Map(primary);
            for (const [k, v] of fallback.entries()) {
                if (!res.has(k)) res.set(k, v);
            }
            return res;
        }

        // ---------- 更健壮的 loadShops ----------
        // ===== 替换原来的 loadShops()：按 order 排序 + 用 color 着色 =====
        async function loadShops() {
            const box = $id('shops');
            if (!box) return;
            box.innerHTML = '';
            SHOPS_INDEX.clear();

            try {
                const resp = await fetch(ENDPOINT_SHOPS);
                if (!resp.ok) {
                    const txt = await resp.text().catch(() => '');
                    throw new Error(`HTTP ${resp.status} ${resp.statusText} ${txt.slice(0, 200)}`);
                }
                const payload = await resp.json();
                const items = Array.isArray(payload) ? payload
                    : Array.isArray(payload?.results) ? payload.results
                        : Array.isArray(payload?.items) ? payload.items : [];

                const pending = [];
                let invalidCount = 0;

                for (const s of items) {
                    const sidRaw = s?.id ?? s?.shop_id ?? s?.pk ?? s?.ID ?? s?.Id;
                    const sid = Number(sidRaw);
                    if (!Number.isFinite(sid)) {
                        invalidCount++;
                        console.warn('[shops] skip invalid id:', s);
                        continue;
                    }

                    const sname = s?.name ?? s?.shop_name ?? s?.display_name ?? String(sid);

                    // 根据规则计算排序键 & 颜色
                    const rule = findRuleForShop(sname, sid);
                    const order = Number.isFinite(rule?.order) ? rule.order : 9999;
                    const color = rule?.color || '';

                    // 组装 DOM（先不插入，放到 pending 等排序后再 append）
                    const label = document.createElement('label');
                    label.title = sname;

                    const input = document.createElement('input');
                    input.type = 'checkbox';
                    input.value = String(sid);
                    input.dataset.name = sname;
                    input.dataset.shopId = String(sid);
                    input.id = `shop_${sid}`;

                    const span = document.createElement('span');
                    span.textContent = sname;
                    if (color) span.style.color = color; // 店铺名着色

                    label.appendChild(input);
                    label.appendChild(span);

                    // 保存以备排序
                    pending.push({order, name: sname, node: label, sid});

                    SHOPS_INDEX.set(sid, sname);
                }

                // 按 order 升序；同 order 内按日文友好排序（可改成 sid 升序）
                pending.sort((a, b) => (a.order - b.order) ||
                    a.name.localeCompare(b.name, 'ja', {sensitivity: 'base', numeric: true}));

                // 一次性插入 DOM
                const frag = document.createDocumentFragment();
                for (const {node} of pending) frag.appendChild(node);
                box.appendChild(frag);

                const errEl = document.getElementById('err');
                if (items.length === 0 && errEl) errEl.textContent = '店舗リストが空です（API 応答を確認してください）';
                if (invalidCount > 0) console.warn(`[shops] skipped ${invalidCount} invalid entries (missing id)`);

            } catch (e) {
                console.error(e);
                $id('err') && ($id('err').textContent = '店舗の読み込みに失敗しました（CORS / 認証 / 応答形式を確認）');
            }
        }

        // ---- JST 的 YYYYMMDD ----
        function formatYmdJST(d) {
            const parts = new Intl.DateTimeFormat('ja-JP', {
                timeZone: 'Asia/Tokyo',
                year: 'numeric', month: '2-digit', day: '2-digit'
            }).formatToParts(d).reduce((acc, p) => (acc[p.type] = p.value, acc), {});
            return `${parts.year}${parts.month}${parts.day}`;
        }

        // ---- 更新主标题中的 8 位日期（优先 #main-title，否则找含“買取相場”的 h4）----
        function updateMainTitleDate(end) {
            const ymd = formatYmdJST(end);
            const el =
                document.getElementById('main-title') ||
                Array.from(document.querySelectorAll('h4')).find(h => /買取相場/.test(h.textContent));
            if (!el) return;

            // 替换末尾的 8 位日期；如果原本没有，就直接在末尾追加
            const txt = el.textContent.trim();
            if (/\d{8}(?!.*\d)/.test(txt)) {
                el.textContent = txt.replace(/\d{8}(?!.*\d)/, ymd);
            } else {
                el.textContent = `${txt}${ymd}`;
            }
        }

        // ---------- 主流程（两按钮各自参照自己的 end） ----------
        async function runWithEnd(endBase, tag, btn) {
            try {
                if (btn) {
                    btn.disabled = true;
                    btn.dataset.t = btn.textContent;
                    btn.textContent = '取得中…';
                }

                const end = floorToMinute(endBase);
                const start = new Date(end.getTime() - 25 * 60 * 1000);
                caption && (caption.textContent = `${tag}（start=${toIsoTZ(start)} / end=${toIsoTZ(end)}）`);

                // 第一次：25 分钟窗口
                const rows1 = await fetchRows(start, end);
                const map1 = buildClosestByRef(rows1, end.getTime());
                const filtered1 = filterOutBelowHalf(map1); // <-- 过滤掉 <50% 的项并在 DOM 上标记 nodata

                fillSingles(filtered1);
                fillAverages(filtered1);
                recalcRangeCells(filtered1);
                highlightRowExtremes();

                // 2 天回填（仅对没有任何数据的店铺）
                const missingShops = getShopsWithNoAnyData();
                let rows2Len = 0;
                if (missingShops.size > 0) {
                    const start2d = new Date(end.getTime() - 12 * 60 * 60 * 1000);
                    console.log(`[PSTA] backfill: ${missingShops.size} shop(s) have no data, searching last 2 days...`);
                    const rows2 = await fetchRows(start2d, end);
                    rows2Len = rows2.length;
                    const map2 = buildClosestByRef(rows2, end.getTime());
                    const filtered2 = filterOutBelowHalf(map2);

                    fillSinglesSelective(filtered2, missingShops);

                    const merged = mergeClosestMaps(filtered1, filtered2); // or mergeClosestMaps(filtered1, filtered2);
                    fillAverages(merged);
                    recalcRangeCells(merged);
                    highlightRowExtremes();

                    // 仍然没有数据的店铺，显示为 “--”
                    for (const sSrv of missingShops) {
                        const tds = document.querySelectorAll(`td[data-shop-id="${sSrv}"][data-iphen-id]`);
                        for (const td of tds) {
                            if (!td.dataset.v) td.textContent = '※要問';
                            if (!td.dataset.v) td.classList.add('nodata')
                        }
                    }
                }
                await fillChangeFromPreviousDay(end);
                if (updatedAtEl) updatedAtEl.textContent = `更新日時：${formatDisplayJP(end)}`;
                updateMainTitleDate(end);

                const cellsDiag = [...document.querySelectorAll('td[data-shop-id][data-iphen-id]')]
                    .slice(0, 20)
                    .map(td => {
                        const sSrv = Number(td.dataset.shopId), iSrv = Number(td.dataset.iphenId);
                        const sKey = serverToMatchShop(sSrv), iKey = serverToMatchIphen(iSrv);
                        return `${sSrv}-${iSrv}  (srv→match: ${sKey}-${iKey})`;
                    });
                console.log('[PSTA] key map sample:\n' + cellsDiag.join('\n'));
                console.log(`[PSTA] ${tag}: rows25m=${rows1.length}${rows2Len ? `, rows2d=${rows2Len}` : ''} (map=${isMappingEnabled()})`);
            } catch (e) {
                console.error(e);
                alert(e.message || 'データ取得に失敗しました');
            } finally {
                if (btn) {
                    btn.disabled = false;
                    btn.textContent = btn.dataset.t || btn.textContent;
                }
            }

        }

        // ---------- 绑定数据获取按钮（如果存在） ----------
        btnPick?.addEventListener('click', () => {
            if (!input?.value) {
                alert('時刻を選択してください');
                return;
            }
            runWithEnd(new Date(input.value), '選択時刻', btnPick);
        });

        // 最新 = 当前时间 - 3 分钟（向下取整到分钟）
        btnNew?.addEventListener('click', () => {
            const endMinus3m = new Date(Date.now() - 3 * 60 * 1000);
            runWithEnd(endMinus3m, '最新', btnNew);
        });

        // ---------- 店铺选择 UI（加载 + 全选/清空） ----------
        $id('select-all-btn')?.addEventListener('click', () => {
            document.querySelectorAll('#shops input[type=checkbox][data-shop-id]').forEach(cb => cb.checked = true);
        });
        $id('clear-all-btn')?.addEventListener('click', () => {
            document.querySelectorAll('#shops input[type=checkbox][data-shop-id]').forEach(cb => cb.checked = false);
        });
        loadShops();

        // ---------- 列隐藏/文字置换 ----------
        function getSelectedShopIds() {
            return Array.from(document.querySelectorAll('#shops input[type="checkbox"]:checked'))
                .map(cb => (cb.dataset.shopId || cb.value))
                .filter(Boolean)
                .map(String); // 统一为字符串以匹配 Map 的 key
        }

        function forEachTable(cb) {
            $qa('.model-section table').forEach(table => cb(table));
        }

        function buildShopHeaderIndexMap(table) {
            const headers = $qa('.shop-col', table.tHead || table); // 店铺列 th（表头）
            let refTr = null, max = 0;
            $qa('tbody tr', table).forEach(tr => {
                const count = tr.querySelectorAll('td[data-shop-id]').length;
                if (count > max) {
                    max = count;
                    refTr = tr;
                }
            });

            const map = new Map();
            if (refTr && headers.length) {
                const shopCells = $qa('td[data-shop-id]', refTr);
                shopCells.forEach((td, i) => map.set(String(td.getAttribute('data-shop-id')), i));
            }
            return {map, headers};
        }

        function hideSelectedShopColumns(shopIds) {
            if (!shopIds.length) return;
            forEachTable(table => {
                const {map, headers} = buildShopHeaderIndexMap(table);
                shopIds.forEach(id => {
                    // 隐藏所有数据格
                    $qa(`tbody td[data-shop-id="${id}"]`, table).forEach(td => td.classList.add('is-hidden'));
                    // 隐藏对应表头
                    const idx = map.get(String(id));
                    if (idx != null && headers[idx]) headers[idx].classList.add('is-hidden');
                });
            });
        }

        function replaceSelectedShopTexts(shopIds, text = '※要問') {
            if (!shopIds.length) return;
            forEachTable(table => {
                shopIds.forEach(id => {
                    $qa(`tbody td[data-shop-id="${id}"]`, table).forEach(td => {
                        if (!td.dataset.origText) td.dataset.origText = td.textContent.trim();
                        td.textContent = text;
                    });
                });
            });
        }

        // ===== 反向操作：再表示（把选中店铺列显示回来）=====
        function showSelectedShopColumns(shopIds) {
            if (!shopIds.length) return;
            forEachTable(table => {
                const {map, headers} = buildShopHeaderIndexMap(table);
                shopIds.forEach(id => {
                    // 1) 还原所有数据格（兼容服务器ID + 本地ID）
                    const sel = shopCellSelectorsFor(id); // 你之前补过的双查选择器
                    const tds = sel ? table.querySelectorAll(sel) : [];
                    tds.forEach(td => td.classList.remove('is-hidden'));

                    // 2) 还原对应表头（优先服务器ID，找不到再试本地ID）
                    const mapped = serverToMatchShop(Number(id));
                    const idx = map.get(String(id)) ?? map.get(String(mapped));
                    if (idx != null && headers[idx]) headers[idx].classList.remove('is-hidden');
                });
            });
        }

        // ===== 反向操作：元文字（把置换成“問い”的格子恢复原文本）=====
        function restoreSelectedShopTexts(shopIds) {
            if (!shopIds.length) return;
            forEachTable(table => {
                shopIds.forEach(id => {
                    const sel = shopCellSelectorsFor(id);
                    const tds = sel ? table.querySelectorAll(sel) : [];
                    tds.forEach(td => {
                        if (td.dataset.origText != null) {
                            td.textContent = td.dataset.origText;
                            delete td.dataset.origText;
                        }
                    });
                });
            });
        }

        // 绑定“非表示 / 置換文字”按钮
        $id('do-not-display')?.addEventListener('click', () => {
            const ids = getSelectedShopIds();
            hideSelectedShopColumns(ids);
        });
        $id('replace-text')?.addEventListener('click', () => {
            const ids = getSelectedShopIds();
            replaceSelectedShopTexts(ids, '※要問');
        });

        $id('display-again')?.addEventListener('click', () => {
            const ids = getSelectedShopIds();
            showSelectedShopColumns(ids);
        });

        $id('display-text')?.addEventListener('click', () => {
            const ids = getSelectedShopIds();
            restoreSelectedShopTexts(ids);
        });
// 兜底：选择器生成（兼容是否做了“本地映射”）
        if (typeof window.shopCellSelectorsFor !== 'function') {
            window.shopCellSelectorsFor = function shopCellSelectorsFor(id) {
                return `tbody td[data-shop-id="${String(id)}"]`;
            };
        }

// 通用绑定器：带控制台日志与空选择提示
        function bindButton(id, handler) {
            const btn = $id(id);
            if (!btn) {
                console.warn(`[PSTA] button #${id} not found`);
                return;
            }
            btn.addEventListener('click', () => {
                console.log(`[PSTA] #${id} clicked`);
                if (typeof getSelectedShopIds !== 'function') {
                    console.error('[PSTA] getSelectedShopIds() not found');
                    return;
                }
                const ids = getSelectedShopIds().map(String);
                if (!ids.length) {
                    alert('店舗を選択してください');
                    return;
                }
                if (typeof handler !== 'function') {
                    console.error(`[PSTA] handler for #${id} is not a function`);
                    return;
                }
                handler(ids);
            });
        }

// 等 DOM Ready 再绑定（或给 <script> 加 defer）
        (function onReady(fn) {
            if (document.readyState === 'complete' || document.readyState === 'interactive') {
                setTimeout(fn, 0);
            } else {
                document.addEventListener('DOMContentLoaded', fn);
            }
        })(() => {
            bindButton('display-again', typeof showSelectedShopColumns === 'function' ? showSelectedShopColumns : null);
            bindButton('display-text', typeof restoreSelectedShopTexts === 'function' ? restoreSelectedShopTexts : null);

            // 也可顺手校验“隐藏/置换”的按钮是否已绑定成功
            bindButton('do-not-display', typeof hideSelectedShopColumns === 'function' ? hideSelectedShopColumns : null);
            bindButton('replace-text', typeof replaceSelectedShopTexts === 'function' ? replaceSelectedShopTexts : null);
        });
    })();
</script>
</body>
</html>
